# MonthLevelDataPlotter output overview

## Excel Report: 
- *Filename*: `{timestamp}_extracted_records_{month}.xlsx`
- Including 5 sheets (`finished_df`, `unfinished_df`, `short_unfinished_df`, `all_progress_df`, `filtered_df`) generated by `MonthLevelDataProcessor` and `MonthLevelDataPlotter`
  
### From YearLevelDataProcessor:
- 2 sheets (`finished_df`, `unfinished_df`) generated by: `MonthLevelDataProcessor` ([â†’ see detail](https://github.com/ThuyHaLE/OptiMoldIQ/blob/main/docs/documentations/analyticsOrchestrator/multiLevelDataAnalytics/OptiMoldIQ_monthLevelDataProcessor_overview.md)) 
- *Data Flow Relationships*:
    ```
                â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                â”‚                     Raw Data Sources                             â”‚
                â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                                            â”‚
                            â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                            â”‚                 â”‚                 â”‚
                            â–¼                 â–¼                 â–¼
                productRecords_df   purchaseOrders_df   moldInfo_df
                            â”‚                 â”‚                 â”‚
                            â”‚                 â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”˜
                            â”‚                           â”‚
                            â–¼                           â–¼
                    filtered_df          MonthLevelDataProcessor
                (record-level)          .product_record_processing()
                [Sheet 5: filtered_df]               â”‚
                                                    â”‚
                                    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                                    â”‚                                 â”‚
                                    â–¼                                 â–¼
                            finished_df                        unfinished_df
                            (PO completed)                     (PO in-progress
                        [Sheet 1: finished_df]               or not started)
                                    â”‚                       [Sheet 2: unfinished_df]
                                    â”‚                                 â”‚
                                    â”‚                                 â”‚
                                    â”‚         â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
                                    â”‚         â”‚                       â”‚
                                    â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”              â”‚
                                    â”‚                  â”‚              â”‚
                                    â–¼                  â–¼              â–¼
                            all_progress_df    short_unfinished_df
                        (combined view)      (essential columns)
                    [Sheet 4: all_progress_df] [Sheet 3: short_unfinished_df]
                
                Legend:
                â”€â”€â”€â”€â”€ : Data transformation/filtering
                â”‚     : One-to-many relationship (aggregation)
                â””â”€â”€â”¬â”€â”€â”˜: Merge/concatenation operation
     ```
- *Sheet Selection Guide*:
    | Use Case                                    | Recommended Sheet      | Reason                          |
    | ------------------------------------------- | ---------------------- | ------------------------------- |
    | Monitoring dashboard                        | short_unfinished_df    | Focused on actionable alerts    |
    | Capacity planning & bottleneck analysis     | unfinished_df          | Full capacity calculation details |
    | Overall month performance report            | all_progress_df        | Unified finished + unfinished view |
    | Time-series production trend analysis       | filtered_df            | Record-level granularity        |
    | On-time delivery rate calculation           | finished_df            | Completed orders only           |
    | Early warning system (overdue/capacity)     | short_unfinished_df    | Pre-filtered risk indicators    |
#### 1. Sheet 1 â€” finished_df:
- *Description*: Contains all purchase orders that have been fully completed (itemRemainQuantity â‰¤ 0) as of the analysis date. This sheet focuses on delivery performance evaluation and includes orders that may have overproduction.
- *Processing Logic*:
    - Filter purchase orders with `poETA` within the target `record_month` and merge with historical backlog orders
    - Merge with production records aggregated by `poNote` to get total produced quantities (`itemGoodQuantity`)
    - Calculate `itemRemainQuantity` = `itemQuantity` - `itemGoodQuantity` (capped at 0 for overproduction cases)
    - Flag orders where `itemRemainQuantity â‰¤ 0` as `poStatus = 'finished'`
    - Classify delivery performance: `etaStatus = 'ontime'` if `lastRecord â‰¤ poETA`, else `'late'`
    - Track overproduction: `overproduction_quantity` = abs(itemRemainQuantity) when negative
- *Key Columns*:
    | Column                                  | Description                               |
    | --------------------------------------- | ----------------------------------------- |
    | poNo                                    | Purchase order number (unique identifier) |
    | poReceivedDate                          | Date when PO was received |
    | poETA                                   | Expected delivery date for the PO |
    | itemCode / itemName / itemCodeName      | Product identification (code, name, combined format) |
    | itemQuantity                            | Total ordered quantity |
    | itemGoodQuantity                        | Total quantity successfully produced |
    | itemRemainQuantity                      | Remaining quantity to produce (â‰¤ 0 for finished orders) |
    | overproduction_quantity                 | Excess quantity produced beyond order requirement |
    | poStatus                                | Production status ('finished') |
    | etaStatus                               | Delivery timeliness ('ontime' or 'late') |
    | firstRecord / lastRecord                | First and last production record dates |
    | moldHistNum                             | Number of unique molds used during production |
    | moldHist                                | List of molds used (slash-separated) |
    | is_backlog                              | Boolean flag indicating if order was carried over from previous months |

#### 2. Sheet 2 â€” unfinished_df:
- *Description*: Contains purchase orders that are either in progress or not yet started, with detailed capacity analysis per mold group. This sheet is critical for production planning, identifying bottlenecks, and forecasting completion risks.
- *Processing Logic*:
    - Combine orders with `poStatus = 'in_progress'` (has production history) and `'not_started'` (no history yet)
    - For **not_started orders**: estimate capacity using `moldSpecificationSummary_df` (available mold list per item)
    - For **in_progress orders**: calculate capacity based on actual `moldHist` (molds already used)
    - Merge mold technical specs (`moldCavityStandard`, `moldSettingCycle`) from `moldInfo_df`
    - Calculate per-mold and total item capacity: `moldMaxHourCapacity = (3600 / moldSettingCycle) * moldCavityStandard`
    - Sort by `moldList` and `poReceivedDate`, then compute cumulative metrics:
       - `accumulatedQuantity`: cumulative remaining quantity per mold group
       - `accumulatedRate`: progress ratio within mold group
    - Estimate lead times:
       - `avgEstimatedLeadtime`: time needed using average mold capacity
       - `totalEstimatedLeadtime`: time needed using all molds simultaneously
       - `avgCumsumLT` / `totalCumsumLT`: cumulative lead time across all orders in same mold group
    - Calculate remaining time windows:
       - `poOTD`: Order-to-Delivery time (poETA - poReceivedDate)
       - `poRLT`: Remaining Lead Time (poETA - analysis_timestamp, 0 if past ETA)
    - Detect capacity issues:
       - `overAvgCapacity`: cumulative lead time exceeds remaining time (single mold scenario)
       - `overTotalCapacity`: exceeds even with all molds (critical overcapacity)
       - `capacityWarning`: combined flag for any capacity risk
       - `capacitySeverity`: 'normal', 'high', or 'critical'
    - Classify ETA status considering both completion and capacity:
        - 'ontime': finished on time OR in progress with sufficient capacity
        - 'late': finished late OR in progress but insufficient capacity
        - 'expected_ontime': not started but capacity sufficient
- *Key Columns*:
    | Column                                  | Description                               |
    | --------------------------------------- | ----------------------------------------- |
    | poNo                                    | Purchase order number |
    | poReceivedDate / poETA                  | Order received date and expected delivery date |
    | itemCodeName                            | Combined item identifier (code + name) |
    | itemQuantity                            | Total ordered quantity |
    | itemGoodQuantity                        | Quantity produced so far (may be null for not_started) |
    | itemNGQuantity                          | Defective quantity produced |
    | itemRemainQuantity                      | Remaining quantity to produce (> 0) |
    | poStatus                                | 'in_progress' or 'not_started' |
    | completionProgress                      | Production completion rate (0.0 to 1.0) |
    | moldNum / moldList                      | Number of molds and their identifiers (slash-separated) |
    | moldHistNum / moldHist                  | Number and list of molds actually used (for in_progress orders) |
    | totalItemCapacity                       | Combined hourly production capacity of all molds |
    | avgItemCapacity                         | Average hourly capacity per mold |
    | accumulatedQuantity                     | Cumulative remaining quantity in the same mold group |
    | accumulatedRate                         | Position ratio within mold group (0.0 to 1.0) |
    | totalRemainByMold                       | Total remaining quantity across all orders using same mold(s) |
    | avgEstimatedLeadtime                    | Estimated days needed (single mold average capacity) |
    | totalEstimatedLeadtime                  | Estimated days needed (all molds working simultaneously) |
    | avgCumsumLT / totalCumsumLT             | Cumulative lead time considering queue of orders on same molds |
    | poOTD                                   | Order-to-Delivery timespan (timedelta) |
    | poRLT                                   | Remaining Lead Time until ETA (timedelta, 0 if overdue) |
    | overAvgCapacity / overTotalCapacity     | Boolean flags for capacity violations |
    | is_overdue                              | Boolean flag: past ETA or insufficient time remaining |
    | etaStatus                               | Delivery risk assessment ('ontime', 'late', 'expected_ontime', 'unknown') |
    | capacityWarning                         | Boolean flag for any capacity concern |
    | capacitySeverity                        | Risk level ('normal', 'high', 'critical') |
    | capacityExplanation                     | Human-readable severity description |
    | is_backlog                              | Boolean flag for orders carried over from previous months |
- *Summary of Relationships*:
    | Sheet              | Derived From               | Aggregation Level | Primary Use                            |
    | ------------------ | -------------------------- | ----------------- | -------------------------------------- |
    | finished_df        | purchaseOrders_df + productRecords_df | PO-level (Purchase Order) | Track completed orders, measure on-time delivery performance |
    | unfinished_df      | purchaseOrders_df + productRecords_df + moldInfo_df + moldSpecificationSummary_df | PO-level with mold capacity analysis | Identify production bottlenecks, forecast lead times, detect capacity risks |

### From YearLevelPlotter:
3 sheets (`short_unfinished_df`, `all_progress_df`, `filtered_df`) generated by `MonthLevelDataPlotter` ([â†’ see detail](https://github.com/ThuyHaLE/OptiMoldIQ/blob/main/docs/documentations/dashboardBuilder/OptiMoldIQ_monthLevelDataPlotter_overview.md))

#### 3. Sheet 3 â€” short_unfinished_df:
- *Description*: Contains unfinished purchase orders with selected essential columns for monitoring and early warning purposes. This is a simplified view of `unfinished_df` focusing on critical operational metrics.
- *Processing Logic*:
    - Filters 18 essential columns from the full `unfinished_df` (which has 44 columns)
    - Removes detailed capacity calculation columns, mold lists, and intermediate metrics
    - Retains only actionable information needed for daily monitoring and alerts
- *Key Columns* (18 columns from `REQUIRED_UNFINISHED_SHORT_COLUMNS`):
    | Column                                  | Description                               |
    | --------------------------------------- | ----------------------------------------- |
    | **Order Identification** | |
    | poNo                                    | Purchase order number (unique identifier) |
    | poETA                                   | Expected delivery date |
    | itemCodeName                            | Combined product identifier (code + name) |
    | **Quantity Metrics** | |
    | itemQuantity                            | Total ordered quantity |
    | itemGoodQuantity                        | Quantity successfully produced so far |
    | itemNGQuantity                          | Defective quantity produced |
    | itemRemainQuantity                      | Remaining quantity to produce (> 0) |
    | **Status & Progress** | |
    | is_backlog                              | Boolean flag: order carried over from previous months |
    | proStatus                               | Production status (e.g., 'in_production', 'pending') |
    | poStatus                                | Purchase order status ('in_progress' or 'not_started') |
    | completionProgress                      | Production completion rate (0.0 to 1.0) |
    | moldHistNum                             | Number of unique molds used during production |
    | **Delivery & Risk Assessment** | |
    | etaStatus                               | Delivery risk ('ontime', 'late', 'expected_ontime', 'unknown') |
    | is_overdue                              | Boolean flag: past ETA or insufficient time remaining |
    | **Capacity Warning Flags** | |
    | overAvgCapacity                         | Boolean: exceeds capacity using average single mold |
    | overTotalCapacity                       | Boolean: exceeds capacity even with all molds (critical) |
    | capacityWarning                         | Boolean: any capacity concern detected |
    | capacitySeverity                        | Risk level ('normal', 'high', 'critical') |
    | capacityExplanation                     | Human-readable severity description |

#### 4. Sheet 4 â€” all_progress_df:
- *Description*: Comprehensive progress tracking dataset combining both finished and unfinished purchase orders. Provides a unified view of all orders in the target month for comparative analysis and overall performance monitoring.  
- *Processing Logic*:
    - Extracts 11 common columns from both `finished_df` and `unfinished_df`
    - Concatenates vertically to create a complete order list
    - Resets index for continuous row numbering
    - Enables cross-status comparison and aggregated reporting
- *Key Columns* (11 columns from `REQUIRED_PROGRESS_COLUMNS`):
    | Column                                  | Description                               |
    | --------------------------------------- | ----------------------------------------- |
    | **Order Identification** | |
    | poNo                                    | Purchase order number (unique across both finished and unfinished) |
    | itemCodeName                            | Combined product identifier |
    | poETA                                   | Expected delivery date |
    | **Order Classification** | |
    | is_backlog                              | Boolean: carried over from previous months |
    | poStatus                                | Current status ('finished', 'in_progress', 'not_started') |
    | proStatus                               | Production status detail |
    | **Quantity Tracking** | |
    | itemQuantity                            | Total ordered quantity |
    | itemGoodQuantity                        | Total good quantity produced |
    | itemNGQuantity                          | Total defective quantity |
    | **Performance Metrics** | |
    | etaStatus                               | Delivery performance ('ontime', 'late', 'expected_ontime', 'unknown') |
    | moldHistNum                             | Number of unique molds used (indicates production complexity) |
- *Usage Notes*:
    - This sheet is ideal for calculating aggregate metrics like total completion rate, on-time delivery percentage
    - Allows filtering and grouping by `poStatus` to compare finished vs unfinished orders
    - `moldHistNum` helps identify multi-mold orders that require more coordination

#### 5. Sheet 5 â€” filtered_df:
- *Description*: Daily production records filtered for the target month up to the analysis date. This is the most granular view, showing individual production transactions rather than aggregated PO summaries.
- *Processing Logic*:
    - Filters `productRecords_df` (raw daily production logs) by two conditions: `recordDate` must (1) be strictly before the analysis timestamp date, and (2)  belong to the adjusted record month (YYYY-MM format)
    - Adds a derived column `recordMonth` for easy month-level grouping
    - Retains all original columns from `productRecords_df` for detailed analysis
- *Key Columns* (all columns from `productRecords_df` + 1 new column):
    | Column                                  | Description                               |
    | --------------------------------------- | ----------------------------------------- |
    | **Date & Time** | |
    | recordDate                              | Date of the production record (datetime) |
    | recordMonth                             | Derived month in YYYY-MM format (added by plotter) |
    | **Order & Product Info** | |
    | poNo / poNote                           | Purchase order identifiers |
    | itemCode / itemName / itemCodeName      | Product identifiers |
    | **Production Quantities** | |
    | itemGoodQuantity                        | Good quantity produced in this record |
    | itemNGQuantity                          | Defective quantity in this record |
    | itemTotalQuantity                       | Total quantity attempted (good + NG) |
    | **Production Details** | |
    | moldCode / moldName                     | Mold used for this production run |
    | machineCode / machineName               | Machine used |
    | operatorCode / operatorName             | Operator responsible |
    | shiftCode / shiftName                   | Work shift |
    | **Process Metrics** | |
    | cycleTime                               | Actual cycle time per piece |
    | cavityUsed                              | Number of cavities used |
    | runTime / downTime                      | Production and non-production time |
    | **Quality & Status** | |
    | qualityStatus                           | Pass/Fail quality check |
    | recordStatus                            | Record validity status |
    | remarks / notes                         | Additional comments |
- *Usage Notes*:
    - This sheet is used for time-series analysis, trend detection, and daily/weekly performance tracking
    - Enables drill-down from PO-level summaries to individual production events
    - Supports visualization of production velocity, quality trends, and resource utilization
    - All records are historical (before analysis date), ensuring data consistency
- *Summary of Relationships*:
    | Sheet              | Derived From               | Aggregation Level | Primary Use                            |
    | ------------------ | -------------------------- | ----------------- | -------------------------------------- |
    |short_unfinished_df | unfinished_df             | PO-level          | Display unfinished POs with key columns for early warning |
    | all_progress_df    | finished_df + unfinished_df | PO-level        | Track overall progress of all POs (both finished and unfinished) |
    | filtered_df        | productRecords_df         | Record-level      | Analyze daily records within the target month before analysis date |

## TXT Report: 

### Final Summary:
- *Filename*: `{timestamp}_final_summary_{month}.txt`
- `final_summary` generated by: `MonthLevelDataProcessor` ([â†’ see detail](https://github.com/ThuyHaLE/OptiMoldIQ/blob/main/docs/documentations/analyticsOrchestrator/multiLevelDataAnalytics/OptiMoldIQ_monthLevelDataProcessor_overview.md))  
- *Description*: A comprehensive text report providing high-level overview of manufacturing performance for the target month. This file serves as an executive summary for quick assessment of production status, delivery performance, and capacity risks. The summary is structured in two main sections: validation parameters and analysis results.
- *Content Structure*:
    -  **Section 1: VALIDATION SUMMARY**
       - Confirms the temporal scope of analysis
       - Documents any automatic adjustments made to analysis parameters
       - Ensures transparency in data availability constraints
    - **Section 2: ANALYSIS RESULTS**
       - Quantifies overall production performance metrics
       - Highlights capacity warnings and bottleneck risks
       - Tracks backlog orders requiring attention
- *Key Metrics*:
    | Metric                            | Meaning                                          |
    | --------------------------------- | ------------------------------------------------ |
    | **VALIDATION SUMMARY SECTION** | |
    | Record month (requested)          | The originally requested target month for analysis (format: YYYY-MM) |
    | Record month (adjusted)           | The actual month used after validation (only shown if different from requested) |
    | Analysis date (validated)         | The final cutoff date for including production records (format: YYYY-MM-DD) |
    | Adjusted from                     | Original analysis date before automatic adjustment (only shown if adjusted due to data availability) |
    | **ANALYSIS RESULTS SECTION** | |
    | Analysis Results for {month}      | Header indicating the target month being analyzed |
    | Analysis date                     | Same as validated analysis date, restated for clarity |
    | Total Orders                      | Total number of purchase orders (POs) in scope: current month + backlog orders |
    | Completed Orders Rate             | Ratio of finished orders to total orders (format: X/Y) |
    | Remaining Orders Rate             | Ratio of unfinished orders to total orders (format: X/Y) |
    | Orders with Capacity Warning      | Count of unfinished orders flagged with `capacityWarning = True` |
    | Capacity Severity Distribution    | Breakdown of unfinished orders by severity level: {'normal': X, 'high': Y, 'critical': Z} |
    | Backlog Orders                    | Count and list of PO numbers carried over from previous months (format: X-[PO1, PO2, ...]) |

### Early Warning Report
- *Filename*: `{timestamp}_early_warning_report_{month}.txt`
- `early_warning_report` generated by: `MonthLevelDataPlotter` ([â†’ see detail](https://github.com/ThuyHaLE/OptiMoldIQ/blob/main/docs/documentations/dashboardBuilder/OptiMoldIQ_monthLevelDataPlotter_overview.md))  
- *Description*: 
    - A text-based analytical report designed to identify potential production and delivery risks in unfinished purchase orders (POs). The report provides an executive overview, highlights capacity-related bottlenecks, and presents prioritized risk categories for proactive intervention.
    - It serves as a monitoring tool to detect critical, high, and medium-severity capacity risks before they escalate into delivery delays or production overloads.
- *Content Structure*:
    - **Section 1: EXECUTIVE SUMMARY**
        - Summarizes key statistics from unfinished POs
        - Highlights severity distribution across critical, high, and medium levels
        - Quantifies overdue and backlog orders
        - Computes an overall Risk Score and assigns a Risk Level Indicator
    - **Section 2: PRIORITY ANALYSIS**
        - Lists orders grouped by risk categories:
        - Priority 1: Critical + Overdue
        - Priority 2: Critical (not overdue)
        - Priority 3: Overdue + Backlog
        - Priority 4: High severity (approaching limit)
    - Displays essential details: PO number, item name, remaining quantity, and status indicators (overdue, backlog, or time remaining)
    - **Section 3: CAPACITY ANALYSIS**
        - Evaluates POs exceeding average or total production capacity
        - Quantifies risk proportion and raises warning messages when critical thresholds are breached
    - **Section 4: ACTIONABLE INSIGHTS & RECOMMENDATIONS**
        - Provides prioritized action items based on current production status
        - Recommends operational interventions such as order rescheduling, customer contact, and resource reallocation
        - Summarizes next steps to prevent escalation of high-severity cases
- *Key Metrics*:
    | Metric                        | Meaning                                                                                                          |
    | ----------------------------- | ---------------------------------------------------------------------------------------------------------------- |
    | **EXECUTIVE SUMMARY SECTION** |                                                                                                                  |
    | Total Active POs              | Total number of unfinished purchase orders (POs) included in the analysis scope                                  |
    | Total Remaining Quantity      | Sum of `itemRemainQuantity` across all unfinished POs                                                            |
    | Severity Breakdown            | Distribution of unfinished POs by `capacitySeverity` levels (`critical`, `high`, `medium`, `normal`)             |
    | Overdue Orders                | Count of POs where `is_overdue = True`, indicating delayed or past-due orders                                    |
    | Backlog Orders                | Count of unfinished POs carried over from previous months (`is_backlog = True`)                                  |
    | Capacity Warning              | Number of POs flagged with `capacityWarning = True` â€” potential overcapacity risks                               |
    | Overall Risk Score            | Composite score calculated as *(10Ã—critical + 5Ã—high + 3Ã—overdue + 2Ã—backlog)* to quantify production risk level |
    | Overall Risk Level            | Categorized based on score: `ðŸŸ¢ MODERATE`, `ðŸŸ¡ HIGH`, or `ðŸ”´ CRITICAL`                                           |

## PNG Visualizations (3 files): 
### 1. Machine-based Dashboard
- *Filename*: `machine_based_dashboard_{month}.png`
- *Generated by*: `machine_based_dashboard_plotter()`
- *Purpose*:
    - Generates a comparative bar chart dashboard summarizing key production performance metrics for each machine.
    - Provides an at-a-glance visualization of multi-metric machine performance â€” such as production quantity, NG rate, working shifts, and downtime.
    - Useful for monthly or overall efficiency monitoring across multiple machines.
- *Input Features*:
    | Feature                                  | Description                                                   |
    | ---------------------------------------- | ------------------------------------------------------------- |
    | `df`                                     | Machine-based production records dataframe                    |
    | `recordDate`                             | Date of production record (used for grouping and labeling)    |
    | `workingShift`                           | Shift identifier (used for validation and derived metrics)    |
    | `machineCode`                            | Machine ID (used as X-axis grouping)                          |
    | `itemCode`, `itemName`                   | Product identifiers (for count aggregations)                  |
    | `moldNo`, `moldCavity`, `moldShot`       | Mold information for total shot and utilization calculations  |
    | `poNote`                                 | Production order note (used to detect non-productive records) |
    | `itemTotalQuantity`, `itemGoodQuantity`  | Quantities used for NG rate computation                       |
    | `recordMonth`                            | Month identifier (YYYY-MM, used in grouping)                  |
    | `visualization_metric`                   | List of metric names (columns) to visualize                   |
    | `fig_title`                              | Title text for the generated figure                           |
    | `visualization_config_path` *(optional)* | Path to custom JSON config for style and layout overrides     |
- *Processing Logic*:
    - Validation: Ensures all required production-related columns exist via `validate_dataframe()`.
    - Visualization Configuration: Loads default or external visualization config via `load_visualization_config()`.
    - Data Preparation:
        - Calls `process_machine_based_data()` to aggregate per-machine metrics (productive vs non-productive).
            - Purpose: 
                - Performs a complete preprocessing and aggregation pipeline for machine-based production data.
                - Cleans, enriches, and summarizes productivity metrics (productive vs non-productive) for dashboard visualization.
            - Processing Logic:
                - Enriches dataset with derived features (`itemComponent`, `recordInfo`, `recordMonth`) using `add_new_features()`.
                - Identifies and aggregates non-productive shifts/days via `process_not_progress_records()`.
                - Filters productive records only for main statistics.
                - Computes aggregated KPIs per machine (or per month Ã— machine) using `calculate_aggregations()`.
                - Merges all results with `merge_by_fields()` into one unified summary table.
    - Layout Calculation: Automatically determines optimal subplot grid size with `find_best_ncols()` and `generate_coords()`.
    - Plotting Workflow:
        - Iterates through each selected metric in visualization_metric:
            - Creates bar plots for each machine (metric values on Y-axis, machine index on X-axis).
            - Annotates bars with value labels (auto-scaled, formatted via format_value_short()).
            - Highlights lowest metric value per plot with red labels.
            - Adds baseline lines for min/max thresholds.
            - Removes unnecessary axes and stylizes spines and gridlines.
            - Dynamically hides unused subplot cells.
- *Output Features*:
    | Output                               | Type                       | Description                                            |
    | ------------------------------------ | -------------------------- | ------------------------------------------------------ |
    | `machine_based_dashboard_{date}.png` | `.png` image               | Composite bar chart dashboard (machines Ã— metrics)     |
    | `Figure` object                      | `matplotlib.figure.Figure` | Returned figure handle (for display or saving)         |
    | **Subplots**                         | Variable (auto-arranged)   | Each subplot visualizes one metric across all machines |
    | **Legend**                           | Auto-generated             | Maps machine index to machine code and color           |
    | **Title**                            | `fig_title` string         | Displays overall dashboard title above figure          |
    
### 2. Mold-based Dashboard:
- *Filename*: `mold_based_dashboard_{month}.png`    
- *Generated by*: `mold_based_dashboard_plotter()`
- *Purpose*:
    - Generates a comparative multi-metric dashboard summarizing key production and quality metrics for each *mold*.
    - Enables quick visual assessment of mold utilization, performance consistency, and NG rate distribution.
    - Useful for monthly or overall mold performance monitoring across multiple machines or product setups.
- *Input Features*:
    | Feature                                  | Description                                                   |
    | ---------------------------------------- | ------------------------------------------------------------- |
    | `df`                                     | Mold-based production records dataframe                       |
    | `recordDate`                             | Production record date (used for filtering and labeling)       |
    | `workingShift`                           | Production shift ID (used for validation and data separation)  |
    | `machineCode`, `machineNo`               | Machine identifiers used to compute distribution by mold       |
    | `itemCode`, `itemName`                   | Product information for aggregation and validation             |
    | `poNote`                                 | Production order note (used to filter out non-productive runs) |
    | `moldNo`                                 | Mold identifier (main grouping key for summarization)          |
    | `moldShot`, `moldCavity`                 | Mold shot count and cavity info for total shot and utilization |
    | `itemTotalQuantity`, `itemGoodQuantity`  | Quantities used to compute yield and NG rates                  |
    | `recordMonth`                            | Monthly grouping key (format: YYYY-MM)                         |
    | `visualization_metric`                   | List of metric names (columns) to visualize                    |
    | `fig_title`                              | Title text for the generated figure                            |
    | `visualization_config_path` *(optional)* | Path to a JSON file overriding visualization style/layout       |
- *Processing Logic*:
    - Validation: Ensures all required columns exist using `validate_dataframe()`.
    - Visualization Configuration: Loads default or external visualization config via `load_visualization_config()`.
    - Data Preparation:  
        - Invokes `process_mold_based_data()` to summarize mold-level metrics.  
            - Purpose: Aggregate and compute productivity and quality statistics per mold (optionally by month).  
            - Processing Logic:  
                - Filters out invalid rows where `itemTotalQuantity <= 0`.  
                - Selects relevant columns for analysis (mold, machine, shot, cavity, quantities).  
                - Groups by `moldNo` (or `(recordMonth, moldNo)` if `group_by_month=True`).  
                - Computes key indicators:  
                    - `totalShots`: Sum of `moldShot`.  
                    - `machineNums` / `machineList`: Machines using the mold.  
                    - `cavityNums`, `avgCavity`, `cavityList`: Mold design details.  
                    - `totalQuantity`, `goodQuantity`, `totalNG`, `totalNGRate`: Quality performance metrics.  
                - Sorts molds by total shot count (descending) for clear visual ranking.  
                - Returns summarized table ready for plotting.  
    - Visualization Setup: figure layout (16Ã—16 default).  
    - Plotting Workflow:
        - Creates one subplot per metric in `visualization_metric`.  
        - For each metric:
            - Plots vertical bar chart with molds on X-axis and metric values on Y-axis.  
            - Adds light background, custom gridlines, and minimal frame style.  
            - Annotates each bar with formatted metric value (via `format_value_short()`), highlighting the *lowest value* in red.  
            - Draws horizontal reference lines for min and max thresholds.  
            - Hides unnecessary spines and ticks for a cleaner dashboard layout.  
        - Adds a unified legend mapping mold indices `(index)-moldNo` with corresponding color. 
- *Output Features*:
    | Output                               | Type                       | Description                                            |
    | ------------------------------------ | -------------------------- | ------------------------------------------------------ |
    | `mold_based_dashboard_{date}.png`    | `.png` image               | Composite bar chart dashboard (molds Ã— metrics)        |
    | `Figure` object                      | `matplotlib.figure.Figure` | Returned figure handle (for preview or saving)         |
    | **Subplots**                         | Variable (auto-arranged)   | Each subplot visualizes one metric across all molds    |
    | **Legend**                           | Auto-generated             | Maps index â†’ moldNo â†’ color                            |
    | **Title**                            | `fig_title` string         | Displays overall dashboard title above figure          |

### 3. Month Performance Dashboard:
- *Filename*: `month_performance_dashboard_{month}.png`
- *Generated by*: `month_performance_plotter()`
- *Purpose*:
    - Generates a dashboard summarizing key production and order fulfillment metrics.
    - Integrates progress, backlog, NG rate, and capacity insights into a single multi-plot figure for management review.
    - Designed to monitor monthly production efficiency, overdue rates, and manufacturing capacity utilization across all POs (Production Orders).
- *Input Features*:
    | Feature / DataFrame                      | Description                                                                 |
    | ---------------------------------------- | --------------------------------------------------------------------------- |
    | `unfinished_df`                          | DataFrame containing **in-progress or unfinished** production orders        |
    | `all_progress_df`                        | DataFrame containing **all production progress records** (finished + ongoing) |
    | `fig_title`                              | Title text displayed at the top of the dashboard                            |
    | `visualization_config_path` *(optional)* | Path to custom visualization configuration (JSON)                           |
    | **REQUIRED_UNFINISHED_COLUMNS**          | `poNo`, `poETA`, `itemQuantity`, `itemGoodQuantity`, `itemNGQuantity`, `is_backlog`, `itemCodeName`, `proStatus`, `poStatus`, `moldHistNum`, `itemRemainQuantity`, `completionProgress`, `etaStatus`, `overAvgCapacity`, `overTotalCapacity`, `is_overdue`, `capacityWarning`, `capacitySeverity`, `capacityExplanation` |
    | **REQUIRED_PROGRESS_COLUMNS**            | `poNo`, `itemCodeName`, `is_backlog`, `poStatus`, `poETA`, `itemNGQuantity`, `itemQuantity`, `itemGoodQuantity`, `etaStatus`, `proStatus`, `moldHistNum` |
- *Processing Logic*:
    - Validation: Ensures both input DataFrames (`unfinished_df`, `all_progress_df`) contain all required columns using `validate_dataframe()`.
    - Visualization Configuration: Loads default or external visualization config via `load_visualization_config()`.
- *Plotting Workflow*:
    - Sequentially populates subplots with specialized analytics visualizations:
        | Plot Function                        | Purpose / Insight                                                                                                                                                                                |
        | ------------------------------------ | ------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------ |
        | **`plot_progress_bar()`**            | Visualizes **overall monthly production completion** using a gradient progress bar â€” computes total `itemGoodQuantity / itemQuantity` and styles it with color-coded progress tiers (redâ†’green). |
        | **`plot_po_status_pie()`**           | Shows **distribution of ETA statuses** (`etaStatus`) for POs under a specific `poStatus` (e.g., *in-progress*, *finished*, *not-started*), revealing on-time vs delayed proportions.             |
        | **`plot_backlog_analysis()`**        | Compares **backlog vs non-backlog PO counts**, highlighting how many orders are pending backlog (`is_backlog = True`) versus active.                                                             |
        | **`plot_overdue_analysis()`**        | Displays **overdue vs on-time breakdown** of POs (`is_overdue`) segmented by their `poStatus` â€” identifies which stages have most overdue orders.                                                |
        | **`plot_capacity_warning_matrix()`** | Generates a **heatmap of capacity issues**, cross-tabulating `capacityWarning` vs `capacitySeverity` to show where and how severe capacity constraints are.                                      |
        | **`plot_top_items_bar()`**         | Displays **Top 10 items with the largest remaining quantities** (`itemRemainQuantity`) in a horizontal bar chart. Also annotates each bar with its completion rate (`completionProgress`) and quantity, revealing which unfinished items dominate the workload. |
        | **`plot_capacity_severity()`**     | Shows **distribution of capacity severity levels** (`capacitySeverity`) across POs, using color-coded bars to highlight how many orders fall into each severity class (e.g., *low*, *medium*, *high*).                                                          |
        | **`plot_progress_distribution()`** | Analyzes **how POs are distributed across completion ranges** (`completionProgress`), grouping them into progress bins (0â€“25%, 25â€“50%, 50â€“75%, 75â€“100%) to visualize production progress spread.                                                                |
        | **`plot_mold_nums()`**             | Summarizes **mold usage diversity** among *finished* POs, showing how many orders were completed using each `moldHistNum` â€” a quick indicator of mold workload and utilization.                                                                                 |
        | **`plot_late_items_bar()`**          | Highlights **items with `etaStatus = 'late'`** by plotting their `itemRemainQuantity` in a horizontal bar chart â€” helps identify delayed items and visualize their completion progress vs remaining quantity. Bars are color-coded by `poStatus` for quick differentiation. |
        | **`plot_top_ng_items_bar()`**        | Displays **Top 10 items with the highest NG rate** (`itemNGQuantity / (itemGoodQuantity + itemNGQuantity)`), enabling detection of quality issues. Each bar shows NG% and total quantity, color-coded by `poStatus`.                                                        |
        | **`plot_ng_rate()`**                 | Visualizes **distribution of NG rate bins (0â€“20%, 20â€“40%, â€¦)** using a stylized bar chart with patterned overlays. Highlights how many POs fall into each NG quality band, with â€œNot Progressâ€ bin representing unstarted or zero-output orders.                            |
        | **`plot_kpi_cards()`**               | Summarizes **key KPI metrics** in colored dashboard cards â€” e.g., total POs, backlog, finished, in-progress, not-started, late POs, and progress averages. Provides a compact high-level snapshot of production status and quality.                                         |
    - Each subplot is styled consistently using theme-defined font sizes (`sizes`), colors (`colors`), and spacing parameters.
    - All axes, legends, and labels are harmonized for a clean, presentation-ready layout.
- *Output Features*:
    | Output                                   | Type                       | Description                                                    |
    | ---------------------------------------- | -------------------------- | -------------------------------------------------------------- |
    | `month_performance_dashboard_{date}.png` | `.png` image               | Full-page dashboard combining progress, backlog, and NG charts |
    | `Figure` object                          | `matplotlib.figure.Figure` | Returned figure handle for inline preview or file export       |
    | **Subplots**                             | 10+ grid-arranged sections | Each section visualizes a distinct monthly performance aspect  |
    | **Legend & Colors**                      | Auto-generated             | Consistent thematic color mapping via configuration palette     |
    | **Title**                                | `fig_title` string         | Central dashboard header displayed above all subplots           |